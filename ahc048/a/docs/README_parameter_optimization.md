# AHC048 ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ãƒ„ãƒ¼ãƒ«

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€AtCoder Heuristic Contest 048ã€ŒMixing on the Paletteã€å•é¡Œã®è§£ç­”ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«ãŠã‘ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è‡ªå‹•çš„ã«æœ€é©åŒ–ã™ã‚‹ãŸã‚ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# ç°¡å˜ãªæœ€é©åŒ–ã‚’å®Ÿè¡Œ
./optimize_params.sh quick

# ã‚ˆã‚Šè©³ç´°ãªæœ€é©åŒ–
./optimize_params.sh full
```

## ğŸ“‹ æœ€é©åŒ–å¯èƒ½ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

### ç„¼ããªã¾ã—æ³•ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- `timeLimit`: å®Ÿè¡Œæ™‚é–“åˆ¶é™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 2.8ç§’ï¼‰
- `startTemp`: é–‹å§‹æ¸©åº¦ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 100.0ï¼‰
- `endTemp`: çµ‚äº†æ¸©åº¦ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.1ï¼‰

### æˆ¦ç•¥ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- `baseQualityThreshold`: åŸºæœ¬å“è³ªé–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.4ï¼‰
- `urgencyMultiplier`: ç·Šæ€¥åº¦ä¹—æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.3ï¼‰
- `urgencyThreshold`: ç·Šæ€¥åº¦é–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.5ï¼‰
- `relaxedQualityThreshold`: ç·©ã„å“è³ªé–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.6ï¼‰
- `consecutiveFailureLimit`: é€£ç¶šå¤±æ•—é™ç•Œï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 3ï¼‰

### è©•ä¾¡é–¢æ•°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
- `capacityWeight`: å®¹é‡é‡ã¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10.0ï¼‰
- `colorDistanceWeight`: è‰²è·é›¢é‡ã¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 100.0ï¼‰
- `emptyWellColorWeight`: ç©ºã‚¦ã‚§ãƒ«è‰²é‡ã¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 50.0ï¼‰
- `topTubeCount`: ä¸Šä½ãƒãƒ¥ãƒ¼ãƒ–æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 3ï¼‰

### ã‚¦ã‚§ãƒ«é¸æŠãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆæ–°æ©Ÿèƒ½ï¼‰
- `randomWellProbability`: ãƒ©ãƒ³ãƒ€ãƒ ã‚¦ã‚§ãƒ«é¸æŠç¢ºç‡ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.3ï¼‰
- `explorationBonus`: æ¢ç´¢ãƒœãƒ¼ãƒŠã‚¹é‡ã¿ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 2.0ï¼‰
- `adaptiveWellSelection`: é©å¿œçš„ã‚¦ã‚§ãƒ«é¸æŠã®æœ‰åŠ¹åŒ–ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: trueï¼‰
- `adaptationRate`: é©å¿œç‡ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.1ï¼‰
- `diversityCheckCount`: å¤šæ§˜æ€§ãƒã‚§ãƒƒã‚¯å¯¾è±¡æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5ï¼‰

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### 1. Makefileã‚’ä½¿ç”¨

```bash
# ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
make all

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®å®Ÿè¡Œ
make optimize          # ã‚¯ã‚¤ãƒƒã‚¯æœ€é©åŒ–
make grid-search      # ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒ
make genetic          # éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
make full-optimize    # ãƒ•ãƒ«æœ€é©åŒ–

# çµæœã®ç¢ºèª
make check-results

# ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
make clean
```

### 2. æœ€é©åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨

```bash
# ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
./optimize_params.sh help

# å„ç¨®æœ€é©åŒ–ã®å®Ÿè¡Œ
./optimize_params.sh quick           # 30å›ã®ãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ¼ãƒ
./optimize_params.sh random 100     # 100å›ã®ãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ¼ãƒ
./optimize_params.sh grid           # ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒ
./optimize_params.sh genetic        # éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
./optimize_params.sh full           # å…¨æ‰‹æ³•ã‚’é †æ¬¡å®Ÿè¡Œ
```

### 3. ç›´æ¥å®Ÿè¡Œ

```bash
# ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
g++ -std=c++17 -O2 -o parameter_optimizer parameter_optimizer.cpp

# å®Ÿè¡Œ
./parameter_optimizer random 50
./parameter_optimizer grid
./parameter_optimizer genetic
```

## ğŸ“Š æœ€é©åŒ–æ‰‹æ³•

### 1. ãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ¼ãƒ
- **æ¦‚è¦**: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã—ã¦è©•ä¾¡
- **åˆ©ç‚¹**: é«˜é€Ÿã€å®Ÿè£…ãŒç°¡å˜
- **ç”¨é€”**: åˆæœŸæ¢ç´¢ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è¨­å®š

### 2. ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒ
- **æ¦‚è¦**: ä¸»è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ ¼å­ç‚¹ã‚’ç³»çµ±çš„ã«æ¢ç´¢
- **åˆ©ç‚¹**: ç¢ºå®Ÿæ€§ãŒé«˜ã„ã€å†ç¾æ€§ãŒã‚ã‚‹
- **ç”¨é€”**: é‡è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ç²¾å¯†èª¿æ•´

### 3. éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- **æ¦‚è¦**: ç”Ÿç‰©ã®é€²åŒ–ã‚’æ¨¡å€£ã—ãŸæœ€é©åŒ–æ‰‹æ³•
- **åˆ©ç‚¹**: å±€æ‰€æœ€é©è§£ã®å›é¿ã€è¤‡é›‘ãªç›¸äº’ä½œç”¨ã®è€ƒæ…®
- **ç”¨é€”**: é«˜ç²¾åº¦ãªæœ€é©åŒ–ã€è¤‡æ•°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®åŒæ™‚èª¿æ•´

## ğŸ“ˆ çµæœã®è©•ä¾¡

### å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«
- `random_search_results.txt`: ãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ¼ãƒã®çµæœ
- `grid_search_results.txt`: ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒã®çµæœ
- `genetic_results.txt`: éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®çµæœ

### è©•ä¾¡æŒ‡æ¨™
å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ä»¥ä¸‹ã®æŒ‡æ¨™ã§è©•ä¾¡ã•ã‚Œã¾ã™ï¼š
```
Score = 1 + D Ã— (V - H) + round(10^4 Ã— E)
```
- `V`: ãƒãƒ¥ãƒ¼ãƒ–ä½¿ç”¨å›æ•°
- `H`: ç›®æ¨™è‰²æ•°
- `D`: ãƒãƒ¥ãƒ¼ãƒ–ã‚³ã‚¹ãƒˆ
- `E`: è‰²èª¤å·®ã®åˆè¨ˆ

## ğŸ”§ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®è¿½åŠ 
1. `test_input.txt`, `test_advanced.txt`, `test_complex.txt` ã‚’ç”¨æ„
2. ä»¥ä¸‹ã®å½¢å¼ã§è¨˜è¿°:
```
N K H T D
c1 m1 y1    # ãƒãƒ¥ãƒ¼ãƒ–è‰²1
c2 m2 y2    # ãƒãƒ¥ãƒ¼ãƒ–è‰²2
...
target_c1 target_m1 target_y1    # ç›®æ¨™è‰²1
target_c2 target_m2 target_y2    # ç›®æ¨™è‰²2
...
```

### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç¯„å›²ã®èª¿æ•´
`ParameterOptimizer::generateRandomParams()` é–¢æ•°å†…ã§å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ç¯„å›²ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚

### æ–°ã—ã„æœ€é©åŒ–æ‰‹æ³•ã®è¿½åŠ 
1. `ParameterOptimizer` ã‚¯ãƒ©ã‚¹ã«æ–°ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
2. `ParameterTuner` ã‚¯ãƒ©ã‚¹ã«å¯¾å¿œã™ã‚‹å®Ÿè¡Œãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
3. Makefile ã¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’è¿½åŠ 

## ğŸ“ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. æ®µéšçš„æœ€é©åŒ–
```bash
# ã‚¹ãƒ†ãƒƒãƒ—1: ç²—ã„æ¢ç´¢
./optimize_params.sh random 50

# ã‚¹ãƒ†ãƒƒãƒ—2: æœ‰æœ›é ˜åŸŸã®è©³ç´°æ¢ç´¢
./optimize_params.sh grid

# ã‚¹ãƒ†ãƒƒãƒ—3: å¾®èª¿æ•´
./optimize_params.sh genetic
```

### 2. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é©ç”¨
æœ€é©åŒ–å¾Œã€å¾—ã‚‰ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ `main.cpp` ã«é©ç”¨ï¼š
```cpp
// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æœ€é©åŒ–çµæœã§æ›´æ–°
OptimizationParams defaultParams;
defaultParams.timeLimit = 2.5;          // æœ€é©åŒ–çµæœã‹ã‚‰
defaultParams.startTemp = 150.0;        // æœ€é©åŒ–çµæœã‹ã‚‰
defaultParams.baseQualityThreshold = 0.35;  // æœ€é©åŒ–çµæœã‹ã‚‰
// ... ä»–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚‚åŒæ§˜ã«æ›´æ–°
```

### 3. æ¤œè¨¼
```bash
# æœ€é©åŒ–å‰ã®ã‚¹ã‚³ã‚¢è¨˜éŒ²
make benchmark > before_optimization.txt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é©ç”¨å¾Œ
make benchmark > after_optimization.txt

# æ”¹å–„ã‚’ç¢ºèª
diff before_optimization.txt after_optimization.txt
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼
```bash
# C++17å¯¾å¿œã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®ç¢ºèª
g++ --version

# å¿…è¦ã«å¿œã˜ã¦ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ
# macOS: brew install gcc
# Ubuntu: sudo apt install g++
```

### å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼
```bash
# ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª
ls -la test_*.txt

# æ¨©é™ã®ç¢ºèª
chmod +x optimize_params.sh

# ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰
make debug
```

### ãƒ¡ãƒ¢ãƒªä¸è¶³
```bash
# æœ€é©åŒ–ã®è¦æ¨¡ã‚’ç¸®å°
./optimize_params.sh random 10    # å°‘ãªã„ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
```

## ğŸ“š å‚è€ƒæƒ…å ±

### ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ç†è«–
- [ç„¼ããªã¾ã—æ³•](https://ja.wikipedia.org/wiki/ç„¼ããªã¾ã—æ³•)
- [éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ](https://ja.wikipedia.org/wiki/éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ )
- [ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒ](https://scikit-learn.org/stable/modules/grid_search.html)

### AtCoderé–¢é€£
- [AtCoder Heuristic Contest](https://atcoder.jp/contests/archive?ratedType=3)
- [ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ãŠã‘ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´](https://qiita.com/thun-c/items/058743a25c37c87b8aa4)

## ğŸ¤ è²¢çŒ®

ãƒã‚°å ±å‘Šã‚„æ”¹å–„ææ¡ˆã¯ Issue ã¾ãŸã¯ Pull Request ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚ 
