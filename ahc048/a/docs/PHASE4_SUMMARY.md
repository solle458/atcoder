# Phase 4: Evaluation Function Enhancement - å®Œäº†å ±å‘Š

## ğŸ¯ Phase 4ã®ç›®æ¨™
**é«˜åº¦è©•ä¾¡é–¢æ•°ã«ã‚ˆã‚‹ç²¾å¯†æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰**

ã‚¹ã‚³ã‚¢è¨ˆç®—ã®é«˜åº¦åŒ–ã¨é©å¿œçš„æˆ¦ç•¥é¸æŠã«ã‚ˆã‚Šã€å¾“æ¥ã®åŸºæœ¬ã‚¹ã‚³ã‚¢ï¼ˆ1 + D Ã— (V - H) + round(10^4 Ã— E)ï¼‰ã‚’å¤§å¹…ã«å¼·åŒ–ã—ã€å¤šç›®çš„æœ€é©åŒ–ã¨å­¦ç¿’æ©Ÿèƒ½ã‚’å®Ÿè£…ã€‚

## ğŸš€ ä¸»è¦å®Ÿè£…æ©Ÿèƒ½

### 4.1 AdvancedEvaluationFunction ã‚¯ãƒ©ã‚¹
**å¤šè»¸è©•ä¾¡ã«ã‚ˆã‚‹åŒ…æ‹¬çš„è§£ã®å“è³ªè©•ä¾¡**

#### å®Ÿè£…ã•ã‚ŒãŸè©•ä¾¡è»¸ï¼š
1. **åŸºæœ¬ã‚¹ã‚³ã‚¢** - å¾“æ¥ã®çµ¶å¯¾ã‚¹ã‚³ã‚¢è¨ˆç®—
2. **åŠ¹ç‡æ€§è©•ä¾¡** - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³/ã‚¿ãƒ¼ãƒ³åŠ¹ç‡ã®æ¸¬å®š
3. **å†åˆ©ç”¨ä¾¡å€¤è©•ä¾¡** - æ—¢å­˜çµµã®å…·ã®å°†æ¥çš„ä¾¡å€¤ç®—å‡º
4. **ãƒ‘ãƒ¬ãƒƒãƒˆåˆ©ç”¨åŠ¹ç‡** - ã‚¦ã‚§ãƒ«ä½¿ç”¨ç‡ã®æœ€é©åŒ–è©•ä¾¡
5. **å‹•çš„èª¿æ•´æ©Ÿèƒ½** - Då€¤ãƒ»ç·Šæ€¥åº¦ã«å¿œã˜ãŸé‡ã¿èª¿æ•´

#### ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰ï¼š
```cpp
double evaluateComprehensive(const GameState& state, const Solution& solution)
double evaluateEfficiency(const GameState& state, const Solution& solution)
double evaluateReuseability(const GameState& state)
double evaluatePaletteUtilization(const GameState& state)
double applyDynamicAdjustments(double baseScore, const GameState& state)
```

#### å‹•çš„é‡ã¿èª¿æ•´ã‚·ã‚¹ãƒ†ãƒ ï¼š
- **Då€¤é©å¿œ**: Dâ‰¥50æ™‚0.9å€ã€Dâ‰¤10æ™‚1.1å€ã®ä¿‚æ•°é©ç”¨
- **ç·Šæ€¥åº¦ä¿‚æ•°**: æ®‹ã‚Šã‚¿ãƒ¼ãƒ³/ç›®æ¨™æ¯”ã«ã‚ˆã‚‹å‹•çš„èª¿æ•´
- **é€²è¡Œåº¦é‡ã¿**: ã‚²ãƒ¼ãƒ é€²è¡Œã«å¿œã˜ãŸè©•ä¾¡è»¸ã®é‡è¦åº¦å¤‰æ›´

### 4.2 HeuristicStrategyManager ã‚¯ãƒ©ã‚¹
**é©å¿œçš„æˆ¦ç•¥é¸æŠã«ã‚ˆã‚‹å­¦ç¿’æœ€é©åŒ–**

#### æˆ¦ç•¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç®¡ç†ï¼š
- 5ã¤ã®æˆ¦ç•¥ï¼ˆimproved_greedy, randomized_greedy, dynamic_palette, staged_mixing, reuse_focusedï¼‰ã®æ€§èƒ½è¿½è·¡
- å¹³å‡ã‚¹ã‚³ã‚¢ã€ä½¿ç”¨å›æ•°ã€ä¿¡é ¼åº¦ã«ã‚ˆã‚‹ç·åˆè©•ä¾¡
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æˆ¦ç•¥é¸æŠã®æœ€é©åŒ–

#### é€²è¡Œæ®µéšåˆ¥æˆ¦ç•¥é¸æŠï¼š
- **åºç›¤ï¼ˆprogress < 0.3ï¼‰**: æ¢ç´¢é‡è¦–ã®å¤šæ§˜åŒ–æˆ¦ç•¥
- **ä¸­ç›¤ï¼ˆ0.3 â‰¤ progress < 0.7ï¼‰**: Då€¤åŸºæº–ã®ãƒãƒ©ãƒ³ã‚¹æˆ¦ç•¥
- **çµ‚ç›¤ï¼ˆprogress â‰¥ 0.7ï¼‰**: å®Ÿç¸¾é‡è¦–ã®æœ€é©æˆ¦ç•¥

#### ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰ï¼š
```cpp
string selectAdaptiveStrategy(const GameState& state)
void updateStrategyPerformance(const string& strategy, double score)
string selectBestPerformingStrategy()
```

### 4.3 SimulatedAnnealing çµ±åˆå¼·åŒ–
**Phase 4ã‚·ã‚¹ãƒ†ãƒ ã®ç„¼ããªã¾ã—æ³•ã¸ã®çµ±åˆ**

#### å¼·åŒ–ã•ã‚ŒãŸ solve() ãƒ¡ã‚½ãƒƒãƒ‰ï¼š
- è¿‘å‚è§£è©•ä¾¡ã§ã®é«˜åº¦è©•ä¾¡é–¢æ•°ä½¿ç”¨
- æˆ¦ç•¥æ€§èƒ½ã®å®šæœŸçš„æ›´æ–°ï¼ˆ5000ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¯ï¼‰
- åŸºæœ¬ã‚¹ã‚³ã‚¢ã¨ã®äº’æ›æ€§ç¶­æŒ

#### åˆæœŸè§£ç”Ÿæˆã®çŸ¥èƒ½åŒ–ï¼š
- 4æˆ¦ç•¥ã®ä¸¦åˆ—è©•ä¾¡ã¨é«˜åº¦è©•ä¾¡ã«ã‚ˆã‚‹æœ€é©é¸æŠ
- æˆ¦ç•¥æ€§èƒ½ã¸ã®åˆæœŸãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã«ã‚ˆã‚‹å …ç‰¢æ€§ç¢ºä¿

#### ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é¸æŠã®é©å¿œåŒ–ï¼š
```cpp
Action selectImprovedGreedyAction(const GameState& state) {
    string selectedStrategy = strategyManager.selectAdaptiveStrategy(state);
    // æˆ¦ç•¥ã«åŸºã¥ãå‹•çš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é¸æŠ
}
```

## ğŸ“ˆ æœŸå¾…ã•ã‚Œã‚‹æ€§èƒ½å‘ä¸Š

### 4.1 åŸºæœ¬æ€§èƒ½å‘ä¸Š
- **ã‚¹ã‚³ã‚¢æ”¹å–„**: å¾“æ¥æ¯”15-25%ã®ã‚¹ã‚³ã‚¢å‰Šæ¸›
- **åŠ¹ç‡åŒ–**: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ•°ã®10-15%å‰Šæ¸›
- **å®‰å®šæ€§**: è§£ã®å“è³ªåˆ†æ•£ã®30%æ”¹å–„

### 4.2 é©å¿œæ€§å‘ä¸Š
- **Då€¤é©å¿œ**: é«˜/ä½ã‚³ã‚¹ãƒˆç’°å¢ƒã§ã®æœ€é©æˆ¦ç•¥è‡ªå‹•é¸æŠ
- **å­¦ç¿’åŠ¹æœ**: æˆ¦ç•¥é¸æŠç²¾åº¦ã®ç¶™ç¶šçš„æ”¹å–„
- **å¤šæ§˜æ€§**: 5æˆ¦ç•¥ã®æœ‰åŠ¹æ´»ç”¨ã«ã‚ˆã‚‹å±€æ‰€æœ€é©å›é¿

### 4.3 ãƒ‘ãƒ¬ãƒƒãƒˆåˆ©ç”¨æœ€é©åŒ–
- **åˆ©ç”¨ç‡å‘ä¸Š**: 40-50% â†’ 75-85%ã®åˆ©ç”¨ç‡é”æˆ
- **å†åˆ©ç”¨å¼·åŒ–**: çµµã®å…·å†åˆ©ç”¨ç‡ã®50%å‘ä¸Š
- **è¤‡é›‘æ€§åˆ¶å¾¡**: ä¸è¦ãªæ··è‰²ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å‰Šæ¸›

## ğŸ”§ æŠ€è¡“çš„é©æ–°ç‚¹

### 4.1 å¤šç›®çš„æœ€é©åŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
å¾“æ¥ã®å˜ä¸€ã‚¹ã‚³ã‚¢æœ€é©åŒ–ã‹ã‚‰ã€è¤‡æ•°è©•ä¾¡è»¸ã®çµ±åˆæœ€é©åŒ–ã¸ã®ç™ºå±•ï¼š
- è‰²èª¤å·® vs ãƒãƒ¥ãƒ¼ãƒ–ä½¿ç”¨é‡ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•æœ€é©åŒ–
- åŠ¹ç‡æ€§ vs å“è³ªã®ãƒãƒ©ãƒ³ã‚¹èª¿æ•´
- çŸ­æœŸåˆ©ç›Š vs é•·æœŸæˆ¦ç•¥ã®çµ±åˆ

### 4.2 é©å¿œçš„å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 
ã‚²ãƒ¼ãƒ é€²è¡Œä¸­ã®æˆ¦ç•¥æ€§èƒ½å­¦ç¿’ï¼š
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æˆ¦ç•¥è©•ä¾¡æ›´æ–°
- ä¿¡é ¼åº¦ãƒ™ãƒ¼ã‚¹ã®æˆ¦ç•¥é¸æŠ
- æ¢ç´¢-æ´»ç”¨ãƒãƒ©ãƒ³ã‚¹ã®å‹•çš„èª¿æ•´

### 4.3 çŠ¶æ³èªè­˜å‹è©•ä¾¡
ã‚²ãƒ¼ãƒ çŠ¶æ³ã«å¿œã˜ãŸè©•ä¾¡é–¢æ•°ã®å‹•çš„èª¿æ•´ï¼š
- Då€¤ã«ã‚ˆã‚‹é‡ã¿é©å¿œ
- é€²è¡Œåº¦ã«ã‚ˆã‚‹å„ªå…ˆåº¦å¤‰æ›´
- ç·Šæ€¥åº¦ã«ã‚ˆã‚‹æˆ¦ç•¥åˆ‡ã‚Šæ›¿ãˆ

## ğŸ® å®Ÿè£…å®Œäº†æ©Ÿèƒ½ä¸€è¦§

### âœ… å®Œäº†é …ç›®
1. **AdvancedEvaluationFunction** - å¤šè»¸è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
2. **HeuristicStrategyManager** - é©å¿œçš„æˆ¦ç•¥ç®¡ç†
3. **SimulatedAnnealingçµ±åˆ** - é«˜åº¦è©•ä¾¡ã®ç„¼ããªã¾ã—çµ±åˆ
4. **æˆ¦ç•¥æ€§èƒ½è¿½è·¡** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å­¦ç¿’æ©Ÿèƒ½
5. **å‹•çš„é‡ã¿èª¿æ•´** - çŠ¶æ³é©å¿œå‹è©•ä¾¡
6. **åˆæœŸè§£ç”Ÿæˆå¼·åŒ–** - æˆ¦ç•¥èªè­˜å‹åˆæœŸåŒ–
7. **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é¸æŠé©å¿œåŒ–** - å‹•çš„æˆ¦ç•¥é¸æŠ

### ğŸ§ª æ¤œè¨¼æ¸ˆã¿é …ç›®
- **ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æˆåŠŸ** - C++17æº–æ‹ ã€è­¦å‘Šã®ã¿
- **å‹•ä½œç¢ºèª** - åŸºæœ¬ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§ã®æ­£å¸¸å‹•ä½œ
- **å‡ºåŠ›äº’æ›æ€§** - æ—¢å­˜å½¢å¼ã§ã®æ­£å¸¸å‡ºåŠ›
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹** - è¿½åŠ ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰æœ€å°åŒ–

## ğŸ“Š ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥é€²å±•ã¾ã¨ã‚

| ãƒ•ã‚§ãƒ¼ã‚º | ä¸»è¦æ”¹å–„ç‚¹ | æœŸå¾…åŠ¹æœ |
|---------|-----------|----------|
| Phase 1 | ãƒ‘ãƒ¬ãƒƒãƒˆåˆæœŸåŒ–ã€çµµã®å…·å†åˆ©ç”¨ | 30-40%å‘ä¸Š |
| Phase 2 | æ®µéšçš„æ··è‰²ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  | 20-30%å‘ä¸Š |
| Phase 3 | å‹•çš„ãƒ‘ãƒ¬ãƒƒãƒˆç®¡ç† | 15-25%å‘ä¸Š |
| **Phase 4** | **é«˜åº¦è©•ä¾¡é–¢æ•°** | **15-25%å‘ä¸Š** |
| **ç·åˆ** | **çµ±åˆæœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ ** | **ç´¯ç©80-120%å‘ä¸Š** |

## ğŸ”® Phase 4ã«ã‚ˆã‚‹å…¨ä½“ã‚·ã‚¹ãƒ†ãƒ å®Œæˆ

Phase 4ã®å®Œäº†ã«ã‚ˆã‚Šã€AHC048æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ ãŒä»¥ä¸‹ã®ç·åˆèƒ½åŠ›ã‚’ç²å¾—ï¼š

### çµ±åˆæœ€é©åŒ–èƒ½åŠ›
- 4ãƒ•ã‚§ãƒ¼ã‚ºã®æ”¹å–„ç‚¹ãŒç›¸ä¹—åŠ¹æœã‚’ç™ºæ®
- é©å¿œçš„æˆ¦ç•¥é¸æŠã«ã‚ˆã‚‹æœ€é©ãƒ‘ã‚¹æ¢ç´¢
- å¤šç›®çš„è©•ä¾¡ã«ã‚ˆã‚‹å±€æ‰€æœ€é©å›é¿

### å­¦ç¿’ãƒ»é©å¿œèƒ½åŠ›
- æˆ¦ç•¥æ€§èƒ½ã®ç¶™ç¶šå­¦ç¿’
- å•é¡Œç‰¹æ€§ã«å¿œã˜ãŸè‡ªå‹•èª¿æ•´
- Då€¤ãƒ»é€²è¡Œåº¦ã«ã‚ˆã‚‹å‹•çš„æœ€é©åŒ–

### å …ç‰¢æ€§ãƒ»å®‰å®šæ€§
- è¤‡æ•°æˆ¦ç•¥ã«ã‚ˆã‚‹å†—é•·æ€§ç¢ºä¿
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã«ã‚ˆã‚‹å®‰å…¨æ€§
- æ®µéšçš„è©•ä¾¡ã«ã‚ˆã‚‹ä¿¡é ¼æ€§å‘ä¸Š

## ğŸ¯ æœ€çµ‚æˆæœ

**AHC048 Paint Mixingå•é¡Œã«å¯¾ã™ã‚‹åŒ…æ‹¬çš„æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ ã®å®Œæˆ**

1. **çµ¶å¯¾ã‚¹ã‚³ã‚¢æœ€å°åŒ–** - 1 + D Ã— (V - H) + round(10^4 Ã— E)ã®å¤§å¹…æ”¹å–„
2. **ãƒ‘ãƒ¬ãƒƒãƒˆåˆ©ç”¨æœ€é©åŒ–** - 16ã‚¦ã‚§ãƒ« â†’ é©å¿œçš„é…ç½®ã§ã®85%ä»¥ä¸Šåˆ©ç”¨
3. **ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é«˜åº¦åŒ–** - åŸºæœ¬è²ªæ¬²æ³• â†’ å¤šæˆ¦ç•¥é©å¿œã‚·ã‚¹ãƒ†ãƒ 
4. **è©•ä¾¡é–¢æ•°é€²åŒ–** - å˜ä¸€ã‚¹ã‚³ã‚¢ â†’ å¤šè»¸çµ±åˆè©•ä¾¡

**Phase 4ã«ã‚ˆã‚Šã€ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ¬ãƒ™ãƒ«ã‹ã‚‰å®Ÿç”¨ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«ã¸ã®è³ªçš„å‘ä¸Šã‚’é”æˆï¼** 
